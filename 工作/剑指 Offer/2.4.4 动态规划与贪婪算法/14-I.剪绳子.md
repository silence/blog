给你一根长度为 n 的绳子，请把绳子剪成整数长度的 m 段（m、n都是整数，n>1并且m>1），每段绳子的长度记为 k[0],k[1]...k[m-1] 。请问 k[0]\*k[1]*...*k[m-1] 可能的最大乘积是多少？例如，当绳子的长度是8时，我们把它剪成长度分别为2、3、3的三段，此时得到的最大乘积是18。

```
示例 1：

输入: 2
输出: 1
解释: 2 = 1 + 1, 1 × 1 = 1
```

```
示例 2:

输入: 10
输出: 36
解释: 10 = 3 + 3 + 4, 3 × 3 × 4 = 36
```

提示：

2 <= n <= 58

---

方法一：动态规划

设 F(n) 为长度为 n 的绳子可以得到的最大乘积，对于每一个 F(n)，可以得到如下分解：

![image-20210617221549049](https://raw.githubusercontent.com/silence/blog/assets/assets/20210617221549.png)

**注意到我们每次将一段绳子剪成两段时，剩下的部分可以继续剪，也可以不剪**。因此我们得到了递归函数 `F(n) = max(i x (n-i), i x F(n - i)), i= 1,2,...,n-2`。

```javascript
/**
 * @param {number} n
 * @return {number}
 */
var cuttingRope = function(n) {
  if (n === 2) return 1;
  const dp = Array(n + 1).fill(0)
  // dp[i] = 长度为 i 的绳子的最大乘积
  dp[1] = 1
  dp[2] = 1;
  for(let i = 3; i <= n; i++) {
    for (let j = 1; j <= i - 1; j++) {
    dp[i] =  Math.max(dp[i], Math.max(dp[j] * (i - j), j * (i - j)))
    }
  }
  return dp[n]
};
```

时间复杂度 O(n^2^)，空间复杂度O(n)。

---

方法二：数学推导。

- 设将长度为 n 的绳子切为 a 段：

  $\large n = n1 + n2 + ... + na$

- 本题等价于求解：

  $\large max(n1\times n2 \times ... \times na)$

- 一下公式为“算术几何均值不等式”，等号当且仅当 $n1 = n2=...=na$ 时成立。

  $\large \frac{n1+n2+...+na}{a} \ge \sqrt[a]{n1n2...na}$

  > 得出推论 将绳子 **以相等的长度等分为多段** ，得到的乘积最大。

- 设将绳子按照 x 长度等分为 a 段，即 n = ax，则乘积为 x^a^。观察下式，由于 n 为常数，因此当 $x^\frac{1}{x}$ 取最大值时，乘积达到最大值。

  $\large x^a = x^\frac{n}{x}=(x^\frac{1}{x})^n$

- 根据分析，可将问题转化为求 $y=x^{\frac{1}{x}}$ 的极大值，因此对 x 求导数。

  - 取对数：$\large lny = \frac{1}{x}lnx$
  - 对 x 求导：$\large y=\frac{1-lnx}{x^2}x^{\frac{1}{x}}$

- 令 y = 0，则 1 - lnx = 0，得驻点为 x = e ≈ 2.7。

- x = e 为极大值点，其中 x = 3 时，乘积达到最大。

  > 得出推论 尽可能将绳子以 **长度 3 等分为多段时，乘积最大**。

- 若最后一段绳子长度为 3、2 ，直接相乘即可

- 若最后一段绳子长度为 1，取前一段为 3 的绳子组合为 2 + 2，因为 2*2 > 3\*1

```javascript
var cuttingRope = function(n) {
  if (n === 2) return 1; 
  if (n === 3) return 2;
  const yu = n % 3;
  if (yu === 0) return 3 ** (n/3);
  if (yu === 1) return 3 ** (parseInt(n/3) - 1) * 4;
  if (yu === 2) return 3 ** parseInt(n/3) * 2
}
```

时间复杂度 O(1)，空间复杂度 O(1)。



